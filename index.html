<!DOCTYPE html>
<html lang="ht">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>TF-Chat</title>
<style>
:root {
  --bg:#000;
  --text:#e6eefb;
  --accent:#0b81ff;
  --card:#0b0b0b;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;background:var(--bg);color:var(--text);font-family:Roboto,Arial,sans-serif;overflow:hidden}
header{position:fixed;top:0;left:0;right:0;height:56px;background:var(--card);display:flex;align-items:center;justify-content:center;border-bottom:1px solid rgba(255,255,255,0.1);z-index:10}
header h1{font-size:18px;font-weight:bold}
main{position:absolute;top:56px;bottom:56px;left:0;right:0;overflow-y:auto;padding:12px;display:flex;flex-direction:column-reverse}
.message{max-width:70%;margin:4px 0;padding:10px 14px;border-radius:14px;word-wrap:break-word;font-size:15px}
.sent{background:var(--accent);color:#fff;align-self:flex-end;border-bottom-right-radius:2px}
.received{background:#1a1a1a;color:var(--text);align-self:flex-start;border-bottom-left-radius:2px}
footer{position:fixed;bottom:0;left:0;right:0;height:56px;background:var(--card);display:flex;align-items:center;padding:8px;border-top:1px solid rgba(255,255,255,0.1)}
input,button{border:none;outline:none}
#msgInput{flex:1;padding:10px;border-radius:10px;background:#111;color:var(--text)}
#sendBtn{margin-left:8px;background:var(--accent);color:#fff;padding:10px 16px;border-radius:10px;font-weight:bold}
#contacts{display:none;position:fixed;top:56px;bottom:0;left:0;width:100%;background:rgba(0,0,0,0.95);overflow-y:auto;padding:16px}
.contact{padding:12px;background:#111;margin-bottom:6px;border-radius:8px}
@media(min-width:900px){#contacts{display:none!important}}
</style>
</head>
<body>
<header><h1>TF-Chat</h1></header>

<div id="contacts"></div>

<main id="chatBox"></main>

<footer>
<input type="text" id="msgInput" placeholder="Ekri yon mesaj...">
<button id="sendBtn">Voye</button>
</footer>

<script>
const tfidKey = 'tfid_user';
const chatKey = id => `chat_${id}`;
let tfid = localStorage.getItem(tfidKey);
if(!tfid){
  tfid = prompt("Antre TFID ou:");
  localStorage.setItem(tfidKey, tfid);
}
let messages = JSON.parse(localStorage.getItem(chatKey(tfid)) || '[]');
const chatBox = document.getElementById('chatBox');
const input = document.getElementById('msgInput');
const btn = document.getElementById('sendBtn');

function renderMessages(){
  chatBox.innerHTML = '';
  messages.forEach(msg=>{
    const div = document.createElement('div');
    div.className = 'message ' + (msg.sender===tfid ? 'sent' : 'received');
    div.textContent = msg.text;
    chatBox.appendChild(div);
  });
}

function saveMessages(){
  localStorage.setItem(chatKey(tfid), JSON.stringify(messages));
}

btn.onclick = ()=>{
  const text = input.value.trim();
  if(!text) return;
  const msg = { sender: tfid, text, time: Date.now() };
  messages.push(msg);
  saveMessages();
  input.value = '';
  renderMessages();
};

renderMessages();
</script>
</body>
</html>
